<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Hacker Game</title>
    <style>
      body {
        background-color: black;
        color: white;
        font-family: Consolas, "Courier New", Courier, monospace;
        font-weight: 500;
        font-size: medium;
        white-space: pre;
      }
    </style>
  </head>
  <body>
    <pre id="output"></pre>

    <script>
    function getUserInput(promptText) {
      return new Promise(resolve => {
        const output = document.getElementById("output");
        output.textContent += promptText + " ";
        
        const input = document.createElement("input");
        input.style.cssText = "background:black;color:white;border:none;outline:none;font-family:inherit;font-size:inherit;";
        output.appendChild(input);
        input.focus();
        
        input.addEventListener("keydown", function(event) {
          if (event.key === "Enter") {
            const userInput = input.value;
            input.remove();
            output.textContent += userInput + "\n";
            resolve(userInput);
          }
        });
      });
    }
      function sleep(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
      }
      
      function writer(text, speed = 25) {
        return new Promise(resolve => {
          let i = 0;
          function typeChar() {
            if (i < text.length) {
              document.getElementById("output").textContent += text.charAt(i);
              i++;
              setTimeout(typeChar, speed);
            } else {
              document.getElementById("output").textContent += "\n";
              resolve()
            }
          }
          typeChar()
        });
      }

      function startLoadingDots(baseText, lineIndex, dotCount, intervalMs = 500, charcater) {
        const output = document.getElementById("output")
        let dots = 0

        const interval = setInterval(() => {
          dots = (dots + 1) % (dotCount + 1)
          const lines = output.textContent.split('\n')
          lines[lineIndex] = baseText + `${charcater}`.repeat(dots)
          output.textContent = lines.join('\n')
        }, intervalMs)

        return () => clearInterval(interval)
      }

      async function loading(dotCount, string, interval, time, message) {  //intervall defual = 500
        await writer("")

        const lineIndex = document.getElementById("output").textContent.split("\n").length - 2
        const stopLoading = startLoadingDots(`${message}`, lineIndex, dotCount, `${interval}`, `${string}`)

        await sleep(time)
        stopLoading()
      }
      async function help() {
        await writer("------------------------------")
        await writer("commands:")
        await writer("help - shows this list")
      }
      async function run() {

        await writer("------------------------------")
        await writer("Loading HACKER_TERMINAL.exe")
        await loading(3,".", 500, 5000, "Loading")
        await writer("System initialized.")
        await writer("------------------------------")
        await writer("Installing modules.")
        await loading(3,".", 500, 5000, "Loading")
        await writer("12 Modules loaded.")
        await writer("------------------------------")
        await writer("Please enter user and password.")
        await writer("USER: user")
        await loading(100,"*", 350, 4000, "PASSWORD: ")
        await writer("ACCESS GRANTED.")
        await writer("------------------------------")
        await writer("welcome user if you want to relay instruction please press 1")
        input = 0;
        while (input != 1) {
          input = await getUserInput("> ")
          if (input == 1) {
            await writer("welcome user, your goal is to hack database-101.")
            await writer("this is a database that belongs to the american government.")
            await writer("the database contains all 21 working neuclear launch codes.")
            await writer("you must revtreive all of them.")
            await writer("type 'help' to receive a list of commands.")
          } else {
            await writer("Unknown command.")
          }
        }
        input = 0;
        while (input != "help") {
          input = await getUserInput("> ")
          if (input == "help") {
            help()
          } else {
            await writer("Unknown command.")
          }
        }

      }

      run()
    </script>
  </body>
</html>